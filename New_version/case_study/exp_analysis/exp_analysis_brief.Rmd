---
title: "exp_analysis"
output: html_document
date: "2023-07-11"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "D:/magistrale/tesi/github/dati")
```

Dataset

```{r}
studenti <- read.csv("new_studenti.csv", sep = ";", dec = ",")

studenti$DataNascita=as.factor(studenti$DataNascita)
studenti$Sesso=as.factor(studenti$Sesso)
studenti$Cittadinanza_bin=as.factor(studenti$Cittadinanza_bin)
studenti$PEI=as.factor(studenti$PEI)
studenti$PDB=as.factor(studenti$PDB)
studenti$StatusFinale_bin_prec=as.factor(studenti$StatusFinale_bin_prec)
studenti$debito_prec=as.factor(studenti$debito_prec)
studenti$debito_mate_prec=as.factor(studenti$debito_mate_prec)
#studenti$mate_primo_quad=as.factor(studenti$mate_primo_quad) considero factor o continuo?

#possible responses
# 
studenti$voto_ultima_sett=as.factor(studenti$voto_ultima_sett)
studenti$rischio=as.factor(studenti$rischio)
# studenti$Matematica_finale=as.factor(studenti$Matematica_finale)
# studenti$Matematica_finale=as.factor(studenti$Italiano_finale)
# studenti$Matematica_finale=as.factor(studenti$Inglese_finale)

#possible random effects
# studenti$Settore=as.factor(studenti$Settore)
# studenti$Classe=as.factor(studenti$Classe)

table(studenti$Sesso)
table(studenti$Cittadinanza)
table(studenti$DataNascita)
table(studenti$PEI)
table(studenti$PDB)
table(studenti$Classe)
table(studenti$Settore)
table(studenti$Anno)
```

Male vs Female

```{r}

boxplot(Matematica_finale ~ Sesso, names=c("Female","Male"), col=c("lightblue","blue"), ylab = "Mathematical final grade",xlab = "Gender", data=studenti) #0 Female 1 Male

```
Age

```{r}
boxplot(Matematica_finale ~ DataNascita, names=c("Under","Right","Over"), col=c("aquamarine1","lightblue","blue"), ylab = "Mathematical final grade",xlab = "Regular", data=studenti) #-1 under 0 right 1 over

```

Country

```{r}
boxplot(Matematica_finale ~ Cittadinanza_bin, names=c("Other","Italy"), col=c("lightblue","blue"), ylab = "Mathematical final grade",xlab = "Nationality", data=studenti) #0 Foreign students 1 Italian
table(studenti$Cittadinanza_bin)

```

PDB = 1 if the student follows a personalized teaching plan ("Piano Didattico Personalizzato").

```{r}
boxplot(Matematica_finale ~ PDB, col=c("lightblue","blue"), ylab = "Mathematical final grade",xlab = "PDB", data=studenti) #0 no 1 yes


```

Type of school

```{r}
boxplot(Matematica_finale ~ Settore, names=c("Class","Inter","Scie","S. Umane"), col=c("aquamarine1","cyan2","dodgerblue","blue"), ylab = "Mathematical final grade",xlab = "Type of school", data=studenti)


boxplot(Matematica_finale ~ Classe, col="lightblue", ylab = "Mathematical final grade",xlab = "Class", data=studenti)
```


```{r}
par(mfrow=c(2,3))
boxplot(Matematica_finale ~ Sesso, names=c("Female","Male"), col=c("lightblue","blue"), ylab = "Mathematical final grade",xlab = "Gender", data=studenti) #0 Female 1 Male

boxplot(Matematica_finale ~ DataNascita, names=c("Under","Right","Over"), col=c("aquamarine1","lightblue","blue"), ylab = "Mathematical final grade",xlab = "Regular", data=studenti) #-1 under 0 right 1 over

boxplot(Matematica_finale ~ Cittadinanza_bin, names=c("Other","Italy"), col=c("lightblue","blue"), ylab = "Mathematical final grade",xlab = "Nationality", data=studenti) #0 Foreign students 1 Italian


boxplot(Matematica_finale ~ PDB, col=c("lightblue","blue"), ylab = "Mathematical final grade",xlab = "PDB", data=studenti) #0 no 1 yes

boxplot(Matematica_finale ~ Settore, names=c("C","I","S","SU"), col=c("aquamarine1","cyan2","dodgerblue","blue"), ylab = "Mathematical final grade",xlab = "Type of school", data=studenti)

boxplot(Matematica_finale ~ Classe, col="lightblue", ylab = "Mathematical final grade",xlab = "Class", data=studenti,las=2,cex.axis = 0.8)
```


```{r}
par(mfrow=c(2,3))
boxplot(Matematica_finale ~ Sesso, names=c("Female","Male"),horizontal = TRUE, col=c("lightblue","blue"), xlab = "Mathematical final grade",ylab = "Gender", data=studenti) #0 Female 1 Male

boxplot(Matematica_finale ~ DataNascita, names=c("Under","Right","Over"),horizontal = TRUE, col=c("aquamarine1","lightblue","blue"), xlab = "Mathematical final grade",ylab = "Regular", data=studenti) #-1 under 0 right 1 over

boxplot(Matematica_finale ~ Cittadinanza_bin, names=c("Other","Italy"),horizontal = TRUE, col=c("lightblue","blue"), xlab = "Mathematical final grade",ylab = "Nationality", data=studenti) #0 Foreign students 1 Italian


boxplot(Matematica_finale ~ PDB, col=c("lightblue","blue"),horizontal = TRUE, xlab = "Mathematical final grade",ylab = "PDB", data=studenti) #0 no 1 yes

boxplot(Matematica_finale ~ Settore, names=c("C","I","S","SU"), col=c("aquamarine1","cyan2","dodgerblue","blue"),horizontal = TRUE, xlab = "Mathematical final grade",ylab = "Type of school", data=studenti)

bp <- boxplot(Matematica_finale ~ Classe, col="lightblue",horizontal = TRUE, xlab = "Mathematical final grade",ylab = "Class", data=studenti, las = 1,cex.axis = 0.5)
```

```{r}

hist(studenti$Matematica_finale, xlab = "Mathematical final grade", breaks = 7,col="lightblue", main=".")

```

Assenze Number of absences updated weekly.
Matematica Maths grades average updated weekly.
Italiano Italian literature grades average updated weekly.
Inglese English grades average updated weekly.
NoteMerito Number of notes of merit updated weekly.
NoteImpegno Number of notes of diligence updated weekly.
NoteDisc Number of disciplinary notes updated weekly.
Ritardi Number of delays updated weekly.

```{r}
par(mfrow=c(2,3))
counts <- table(studenti$Matematica_finale, studenti$assenze21)
cols <- rainbow(7)
barplot(counts, col = cols, xlab = "Days of absence")
#legend("topright", legend = rownames(counts), fill = cols, title = "Finale maths grade")

counts <- table(studenti$Matematica_finale, studenti$note_merito21)
cols <- rainbow(7)
barplot(counts, col = cols, xlab = "Merit notes")
#legend("topright", legend = rownames(counts), fill = cols, title = "Finale maths grade")

counts <- table(studenti$Matematica_finale, studenti$note_disciplinari21)
cols <- rainbow(7)
barplot(counts, col = cols, xlab = "Disciplinary notes")
#legend("topright", legend = rownames(counts), fill = cols, title = "Finale maths grade")

counts <- table(studenti$Matematica_finale, studenti$note_impegno21)
cols <- rainbow(7)
barplot(counts, col = cols, xlab = "Commitment notes")
#legend("topright", legend = rownames(counts), fill = cols, title = "Finale maths grade")

counts <- table(studenti$Matematica_finale, studenti$ritardi21)
cols <- rainbow(7)
barplot(counts, col = cols, xlab = "Delays")
#legend("topright", legend = rownames(counts), fill = cols, title = "Finale maths grade")


plot(1,1, type = "n", xaxt = "n", yaxt = "n")
legend("center", legend = rownames(counts), fill = cols, title = "Mathematical final grade")

```
